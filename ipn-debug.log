[2025-05-15T17:03:10.207Z] [IPN_SETUP] SSL verification disabled for development environment
[2025-05-15T17:03:10.209Z] 
=== IPN REQUEST RECEIVED ===
[2025-05-15T17:03:10.209Z] Request URL: http://localhost:3000/api/mobilpay/ipn
[2025-05-15T17:03:10.210Z] Request method: POST
[2025-05-15T17:03:10.210Z] Request headers: {
  "connection": "Keep-Alive",
  "content-length": "42",
  "content-type": "application/x-www-form-urlencoded",
  "host": "localhost:3000",
  "user-agent": "Mozilla/5.0 (Windows NT; Windows NT 10.0; en-GB) WindowsPowerShell/5.1.26100.4061",
  "x-clerk-auth-message": "",
  "x-clerk-auth-reason": "dev-browser-missing",
  "x-clerk-auth-signature": "",
  "x-clerk-auth-status": "signed-out",
  "x-clerk-auth-token": "",
  "x-clerk-clerk-url": "http://localhost:3000/api/mobilpay/ipn",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[2025-05-15T17:03:10.215Z] Raw request body: cipher=test&data=test&env_key=test&iv=test
[2025-05-15T17:03:10.216Z] Form data keys: cipher, data, env_key, iv
[2025-05-15T17:03:10.216Z] Form field cipher: test
[2025-05-15T17:03:10.217Z] Form field data: test
[2025-05-15T17:03:10.217Z] Form field env_key: test
[2025-05-15T17:03:10.217Z] Form field iv: test
[2025-05-15T17:03:10.217Z] Form data received:
[2025-05-15T17:03:10.217Z]   hasEnvKey: true
[2025-05-15T17:03:10.218Z]   hasData: true
[2025-05-15T17:03:10.218Z]   hasIv: true
[2025-05-15T17:03:10.218Z]   hasCipher: true
[2025-05-15T17:03:10.222Z] Failed to decode Netopia response:
[2025-05-15T17:03:10.223Z] Encrypted message length is invalid.
[2025-05-15T17:09:15.001Z] [IPN_SETUP] SSL verification disabled for development environment
[2025-05-15T17:09:15.003Z] 
=== IPN REQUEST RECEIVED ===
[2025-05-15T17:09:15.003Z] Request URL: http://localhost:3000/api/mobilpay/ipn
[2025-05-15T17:09:15.004Z] Request method: POST
[2025-05-15T17:09:15.004Z] Request headers: {
  "connection": "Keep-Alive",
  "content-length": "42",
  "content-type": "application/x-www-form-urlencoded",
  "host": "localhost:3000",
  "user-agent": "Mozilla/5.0 (Windows NT; Windows NT 10.0; en-GB) WindowsPowerShell/5.1.26100.4061",
  "x-clerk-auth-message": "",
  "x-clerk-auth-reason": "dev-browser-missing",
  "x-clerk-auth-signature": "",
  "x-clerk-auth-status": "signed-out",
  "x-clerk-auth-token": "",
  "x-clerk-clerk-url": "http://localhost:3000/api/mobilpay/ipn",
  "x-forwarded-for": "::1",
  "x-forwarded-host": "localhost:3000",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "http"
}
[2025-05-15T17:09:15.005Z] Raw request body: cipher=test&data=test&env_key=test&iv=test
[2025-05-15T17:09:15.006Z] Form data keys: cipher, data, env_key, iv
[2025-05-15T17:09:15.007Z] Form field cipher: test
[2025-05-15T17:09:15.007Z] Form field data: test
[2025-05-15T17:09:15.007Z] Form field env_key: test
[2025-05-15T17:09:15.008Z] Form field iv: test
[2025-05-15T17:09:15.008Z] Form data received:
[2025-05-15T17:09:15.008Z]   hasEnvKey: true
[2025-05-15T17:09:15.008Z]   hasData: true
[2025-05-15T17:09:15.008Z]   hasIv: true
[2025-05-15T17:09:15.009Z]   hasCipher: true
[2025-05-15T17:09:15.012Z] Failed to decode Netopia response:
[2025-05-15T17:09:15.013Z] Encrypted message length is invalid.
[2025-05-15T17:17:26.524Z] [IPN_SETUP] SSL verification disabled for development environment
[2025-05-15T17:17:26.526Z] 
=== IPN REQUEST RECEIVED ===
[2025-05-15T17:17:26.526Z] Request URL: https://localhost:3000/api/mobilpay/ipn
[2025-05-15T17:17:26.527Z] Request method: POST
[2025-05-15T17:17:26.527Z] Request headers: {
  "accept-encoding": ", gzip",
  "content-length": "3421",
  "content-type": "application/x-www-form-urlencoded",
  "host": "e4c0-2a02-2f0d-260d-6c00-6030-7a19-4f1a-11dd.ngrok-free.app",
  "user-agent": "Zend_Http_Client",
  "x-clerk-auth-message": "",
  "x-clerk-auth-reason": "dev-browser-missing",
  "x-clerk-auth-signature": "",
  "x-clerk-auth-status": "signed-out",
  "x-clerk-auth-token": "",
  "x-clerk-clerk-url": "https://e4c0-2a02-2f0d-260d-6c00-6030-7a19-4f1a-11dd.ngrok-free.app/api/mobilpay/ipn",
  "x-forwarded-for": "217.156.103.69",
  "x-forwarded-host": "e4c0-2a02-2f0d-260d-6c00-6030-7a19-4f1a-11dd.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-05-15T17:17:26.529Z] Raw request body: env_key=aKhFgTsXMOabq%2FG0MoE3VD2V4iJu9YIKkYRnVyg7dJ3oAntGUHy3X22dknpft1%2BDASWrPP9UUdL%2F%2Bbh2qF4PMm%2FvqnZ7FObQqst6kF7fTaiKWZevzOFNvij1UqEBBOPf49l5fQikztgfiWHrosJubuzaUjeLYBcT1vlP3InDcKE%3D&data=arYTinLF7BBHTpeaUAXFBF70VBQQ7FYGZNwFdZzbR%2B6lLed4hex%2Fx7oej4haEa2yHPM66OrsHs4dcBdiEoSW4bdVMfvi4f1lvGq4kReKTKlfiDBflnARLoWqDwmizV%2BrQDgE1x3ro5WRxTFEBjNOgzNGnINJA61m1rEceE%2F4KIPpQJ18luaO6C0EpismfLeXXHWHf6G0qxMtgHplxLiZrtRZbuDxuMrF3ZLYvCV3luf5id3j02pYxCvTOrIqTHrHnlAwjOIEi%2B7IHqneqWZc1F2Ov4zONAoxEgCwYodMqauLGa4AEYMoYmUAA6PZhedKr%2Fm1jdKhiEWVTXXyH8rwlyKucgt4kubfsTtQTKw%2FYoR%2BQjYSin8sB7fzKpCtoD5x%2Be%2B6ytFnif7ZU2Ycx6Q%2BSzLW%2FpanqfH4BpBVEkZX8Go6jlzgFYJkdtE0Oaiq6n3w5JbObkXjnsCW257%2FBMMsXhzuMReRNuoFnWMmFZFXwIEzvOEmf1ZpcKDGDKTWSyGezlwWBy%2BRrsPHtoaRkR%2FiNavHhj%2B%2BaF6Ay%2FNP2BfuhHOwuyfOXabHwnyubNyv2sMl%2BeUAu1GEYZoMVx1B%2FinflD89Itl52F5hIcBXWf9HFODVigOdO%2FpJFZS7ajZX9EYb17FAqB45sZdr4oM6Zzd1Q1hyNbOOuYq7PEw%2Byc%2FMfwltXYabWyV8jtkRxlcVM3HXZ5mLMjRkQOhJMu%2BbmLZG4Vt0uOMqPGoPi1Rgvfd3Mfhzc1s4l%2B9w99ZlEotY2tILFdPncHqb1I9lYmj18Rj5y82ozk4Q7Eb7offL5TY82bZmTWmscIiG2PgirHL6GJqNpqc85CuKZXGNmWaKgcWqwS%2B9MPbno7UKdIUunnH6oo44K4bErLfy3vz7xixjDJHwuE%2BYS5%2Fa%2BGXrB2fT5QlHOLNNPdRyIuZuelEc6PLq6xk0nvSE9MDGy4kNhPkEyviSgvHlNscnDHNzKohpos75NCYOEI6BuVXcbBXsSjkS3G7P9nSq0sZP%2BQM%2FjbRH8AA8mEwS36%2Bx5fBTHLdfR4vnZtwAJg1mPcYf9bsAv4Ytra3UM0Lxv3I8NGB%2BWPhEZWu3k7atH83oRvAqn2v5gPeFlCW%2FLR4RSPvjDQ88ZqoTf8hBw5MdkeJplWTx4febfO6xPpKSHczdVR3lCS77xfZFMyvypMDFUYNdnW3wD%2BksIwlKP64QD35cWvl1ZZdbVR3EH74TfeNdjHg5OSdpmkRJfgEuFcS4JGo4Nx%2BrKoGGCRzByY5FdLAEtQwUuTocYbky%2Bgp9nz6wqnXooIZH%2BLB2criG%2Fdsua7khp4DF7FPwlrOJstQjWN327gP74ij0IicZv2u5p2AVVoupXcsubVK1IRWQ33CT76lPgT6GHItpblItuOlQkuuRGyMf6BCsCfeElwgY%2F4sE10%2FllhDuNOsofrQMp1xgBW%2B0cSStsxt2A0eWQ9r5l8Tq5hVVfcw0USGJitRIlHRY8s2gk9%2FDuFB9iQqzZ0WymG8g%2F5lpoIRE%2BoF7cjB4luvCUyL3K%2FQ4B%2FKgzL9f6fIeJKbpHwGieB%2B3chPBp7aGC9CLwX5KIvwXA7WYCAoR%2FvppnRdoBXsrEuXPYTbn3J4jVb2PhxIVSvzPHk5YvI7VHjDfhJQmlv3X7hPnQ6QEjvFhw86Ex5JvrzQiE5i0h7yOoMyPKpe8SxHWQAe%2ByWltkajGepi6I0izazSCo0X5lBk9SmHQSs%2BC%2BIdDjl8lMNheX8LIWfmM5Czxenm05pZml6BFmG9hdVYatOLNFq2kH8toRSwPeDAGT5fXMQqPYFzEgJ6JdZxypiO036rajLyi6zoUlvxU8Hzng7pAoW3lTaZZ6y0vVbYBDvcAK9HgDNXdvGywjisexNT0VLxWips1OIWIJy139Oy5CWI5XaTrldkIb8RUVocdzugJc75MCn2FqPkG%2BkJNFN24XfpJUvfcy64V6SLUp3yk11S8rDAAzn90oUhFFwh3bmT%2F%2FuWYL2Q%2FLVQKOWENXE0L48hnVXfwysxAPTsDzDWVKo0dgpzTv9MGqKDh4P7CqT37WgGRJv4RfEJXt%2FtH8I%2B03DwOBpSSU9bUB1o7lmEsKK%2FQ9LUdbix6VhXBH8DYrrauNkHq%2BzOCwvjM6SbGh6ySt02bKueagd0AFThsHlZH87Uz3sR9%2FDoxZwgBMNkVM7G9UW37MkPieGsgjG8vUhk26fA%2FrtMprIY19zD4RxI6s9ySVxa9R2WE%2BRasj4rR4ZLjsbqxsu6%2Bf%2BhchjiwWHtuwxcgK7Wku92f3DMpBYNmV6EKVjPYXQPmIEpJpMwoJrpTUwXVFvn4OcV83HEf2JXQTq%2FVZ9VK%2FgBMFOPtXCwW4TMKIvlDeMmx1TrGHSAsd2hCSM7fdiQSj3iRUAcOAMFd4vbLf%2Fi4Lhi5auvF7a7rygjzARtJ2jn9mjrTXjl9k1eWhuTVCTMchH3mZDcbPteCrNbTKvxA30NlR8PR5qFGBmvqW8NBDVetf0AKJDHm3OJVCqc%2BPw%2FGtXMiIosStDb5cBp9MGYoJf3Ojae4fxn6grcPys6qVNrDFveaHprigynHdKOymFm%2B3yCPkS7Ytk6jHIzgQPa4BfrISALiNb9TcAfANUdCLKEGnnfp0xEuwFseqjYSgprYqPkOymHIvlm467BcCNhr8mqMfjHkGbhLtBu8fUUdty36tQP53TWygZlK9cGbtMgjWZG6zXk67Qw5P%2BhTalYM6krZfV9EY73DsMSC%2BbTOreVTIDP1RrhrFFUukgBzrg99Upa%2FGQVJSx0gcHQ8r2pE2AX3JQFN38xe%2BB4wTKwOnFxoPScD12K%2B1xD2%2FiCHAuY6WeHH8B6TWN8cnwBkf1awIqQ8OggSvnzw0lLqwdT7jzhKHF8lAk%2FHnMHkM9bIxCfJnI1pI1WW1vkqXFuOYEpepTqW0toQFhlTzlGh33e61%2FQSla%2B4GVRI8Hk6dgH3IeEt%2BgvgA8JHpx1ZAKwjHIDKxWJOfETiZlwbhk5ySxlrQPOCAZQKY9Co3dO9&cipher=aes-256-cbc&iv=fi7dgrkhxNC%2FeCpPEejIsg%3D%3D
[2025-05-15T17:17:26.530Z] Form data keys: env_key, data, cipher, iv
[2025-05-15T17:17:26.530Z] Form field env_key: aKhFgTsXMOabq/G0MoE3VD2V4iJu9YIKkYRnVyg7dJ3oAntGUHy3X22dknpft1+DASWrPP9UUdL/+bh2qF4PMm/vqnZ7FObQqst6kF7fTaiKWZevzOFNvij1UqEBBOPf49l5fQikztgfiWHrosJubuzaUjeLYBcT1vlP3InDcKE=
[2025-05-15T17:17:26.531Z] Form field data: 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
[2025-05-15T17:17:26.531Z] Form field cipher: aes-256-cbc
[2025-05-15T17:17:26.531Z] Form field iv: fi7dgrkhxNC/eCpPEejIsg==
[2025-05-15T17:17:26.532Z] Form data received:
[2025-05-15T17:17:26.532Z]   hasEnvKey: true
[2025-05-15T17:17:26.532Z]   hasData: true
[2025-05-15T17:17:26.532Z]   hasIv: true
[2025-05-15T17:17:26.532Z]   hasCipher: true
[2025-05-15T17:17:26.634Z] Decoded IPN response:
[2025-05-15T17:17:26.635Z] {
  "order": {
    "$": {
      "id": "SUB_1747329369331",
      "timestamp": "1747329369332",
      "type": "card"
    },
    "signature": "2WDB-4K4X-VHSY-QDT8-7GYE",
    "url": {
      "return": "https://e4c0-2a02-2f0d-260d-6c00-6030-7a19-4f1a-11dd.ngrok-free.app/api/mobilpay/return",
      "confirm": "https://e4c0-2a02-2f0d-260d-6c00-6030-7a19-4f1a-11dd.ngrok-free.app/api/mobilpay/ipn",
      "ipn": "https://e4c0-2a02-2f0d-260d-6c00-6030-7a19-4f1a-11dd.ngrok-free.app/api/mobilpay/ipn"
    },
    "invoice": {
      "$": {
        "currency": "RON",
        "amount": "8"
      },
      "details": "Subscription payment",
      "contact_info": {
        "billing": {
          "$": {
            "type": "person"
          },
          "first_name": "Platinum",
          "last_name": "Rizon",
          "address": "Strada Astrelor 57",
          "email": "platinum.socialev@gmail.com",
          "mobile_phone": "0722438098"
        },
        "shipping": {
          "$": {
            "type": "person"
          },
          "first_name": "Platinum",
          "last_name": "Rizon",
          "address": "Strada Astrelor 57",
          "email": "platinum.socialev@gmail.com",
          "mobile_phone": "0722438098"
        }
      }
    },
    "params": {
      "recurring": {
        "expiration_date": "2026-05-15",
        "frequency": {
          "days": "30"
        },
        "auto": "true"
      }
    },
    "ipn_cipher": "aes-256-cbc",
    "mobilpay": {
      "$": {
        "timestamp": "20250515201726",
        "crc": "baf4ce0488c4e73327b9d1432333a8af"
      },
      "action": "confirmed",
      "customer": {
        "$": {
          "type": "person"
        },
        "first_name": "Platinum",
        "last_name": "Rizon",
        "country": "642",
        "city": "Bucharest",
        "address": "Strada+Astrelor+57",
        "email": "platinum.socialev%40gmail.com",
        "mobile_phone": "40722438098"
      },
      "purchase": "2328864",
      "original_amount": "8.00",
      "processed_amount": "8.00",
      "current_payment_count": "1",
      "pan_masked": "990000****5098",
      "rrn": "ANdkkJfTit2W",
      "payment_instrument_id": "101609",
      "installments": "1",
      "error": {
        "_": "Tranzactie aprobata",
        "$": {
          "code": "0"
        }
      }
    }
  }
}
[2025-05-15T17:17:26.636Z] Transaction details:
[2025-05-15T17:17:26.636Z]   orderId: SUB_1747329369331
[2025-05-15T17:17:26.636Z]   status: confirmed
[2025-05-15T17:17:26.637Z]   timestamp: 1747329369332
[2025-05-15T17:17:26.637Z]   amount: 8.00
[2025-05-15T17:17:26.637Z]   maskedCard: 990000****5098
[2025-05-15T17:17:26.637Z]   paymentMethod: 101609
[2025-05-15T17:17:26.637Z]   isRecurring: true
[2025-05-15T17:17:26.638Z]   recurringDetails: {"expiration_date":"2026-05-15","frequency":{"days":"30"},"auto":"true"}
[2025-05-15T17:17:26.638Z]   error: {"_":"Tranzactie aprobata","$":{"code":"0"}}
[2025-05-15T17:17:26.774Z] Found order:
[2025-05-15T17:17:26.775Z] {"id":"6826215999b18ae53eb11e33","orderId":"SUB_1747329369331","userId":"682610c3bbc5ffbd72b05d00","planId":"681f2e8717a7e84735b78931","amount":8,"currency":"RON","status":"PENDING","subscriptionType":"Premium","createdAt":"2025-05-15T17:16:09.560Z","updatedAt":"2025-05-15T17:16:09.560Z","user":{"id":"682610c3bbc5ffbd72b05d00","clerkId":"user_2vB8PWy3gwSXrjXXTer6VVbdxDh","email":null,"firstName":"Feraru","lastName":"Andreusi","university":"uni_13","faculty":"fac_13_1","city":"Arad","year":"4","avatar":null,"isOnboarded":true,"isAdmin":false,"planType":"Basic","createdAt":"2025-05-15T16:05:23.557Z","updatedAt":"2025-05-15T16:06:44.750Z"},"plan":{"id":"681f2e8717a7e84735b78931","name":"Premium","price":8,"currency":"RON","features":["Unlimited projects","Priority support"],"createdAt":"2025-05-10T10:46:31.408Z","updatedAt":"2025-05-15T17:16:09.390Z"}}
[2025-05-15T17:17:26.775Z] Payment validation:
[2025-05-15T17:17:26.775Z]   status: confirmed
[2025-05-15T17:17:26.776Z]   errorCode: 0
[2025-05-15T17:17:26.776Z]   errorMessage: Tranzactie aprobata
[2025-05-15T17:17:26.776Z]   isErrorCode: false
[2025-05-15T17:17:26.776Z]   isSuccessStatus: true
[2025-05-15T17:17:26.776Z]   paymentStatus: COMPLETED
[2025-05-15T17:17:27.329Z] --- IPN DEBUG END ---
[2025-05-16T11:29:20.184Z] [IPN_SETUP] SSL verification disabled for development environment
[2025-05-16T11:29:20.191Z] 
=== IPN REQUEST RECEIVED ===
[2025-05-16T11:29:20.193Z] Request URL: https://localhost:3000/api/mobilpay/ipn
[2025-05-16T11:29:20.194Z] Request method: POST
[2025-05-16T11:29:20.195Z] Request headers: {
  "accept-encoding": ", gzip",
  "content-length": "3455",
  "content-type": "application/x-www-form-urlencoded",
  "host": "544b-2a02-2f0d-260d-6c00-d13-5281-a6f7-9ce4.ngrok-free.app",
  "user-agent": "Zend_Http_Client",
  "x-clerk-auth-message": "",
  "x-clerk-auth-reason": "dev-browser-missing",
  "x-clerk-auth-signature": "",
  "x-clerk-auth-status": "signed-out",
  "x-clerk-auth-token": "",
  "x-clerk-clerk-url": "https://544b-2a02-2f0d-260d-6c00-d13-5281-a6f7-9ce4.ngrok-free.app/api/mobilpay/ipn",
  "x-forwarded-for": "217.156.103.69",
  "x-forwarded-host": "544b-2a02-2f0d-260d-6c00-d13-5281-a6f7-9ce4.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-05-16T11:29:20.199Z] Raw request body: env_key=7jio3WtQVYk49OYdSKhezHaEVbIvoRWfzEm3aCDw1d97m3w10fte7qnewiIHj%2B1KLpH8eg%2BmW1x1j9P3P61cXenTbJZrhiBrPifZybKh9%2FKLdp%2BXemUSGygswjCuklub0uIsVq5tFulZ83TLWsb%2BIczxPWLiBjEWkBFXtrToQn4%3D&data=3LKn85P3Tkjkf3xH1aBAZi1Ee0ho8h5nA%2FWe%2FCLazoFxP5QhVdHcbBGjoQVClC3ST9jQSMrNMNbG88V51FWc9ZoxDo7%2BOoCy4cC3MZDQ%2Fj%2FRKYIRP8R0XgXiJ4HqBRQMnmShDENXKgfwApSIgoCeh2ww0yapmUeQaxZVMWRdIncgHU0Qqlyj1z9AtuIJJa%2FbI8yFO2NP47HtbTVqktcVtDVSGM%2BfDuxGRAlNf2NP3v92cSAnWlmcpKLZxlDhuvH9umTz2iuv7dbxP%2FxM9i%2FstL8%2BiRaaCL3RPV%2BB8mptw178MMDWYr9w%2BPZwEOMy1voKyh8m8lKeSwYI5fuzK8v9h7S8gybe%2Fwi7kBQhnhuyt%2BVQ6WI16TK0uqq%2FbvTgHOlt8ot8GtNLAFel2MBO2bcZYd1en2ou23yk5luQgqaiY3xqPS0Wi%2B5ngP9U3yzjPPlsUTq58E7uLnZUX8OuMQdyqdAuG4KB9YSKfGJzpuVpm9oZ4e2q5Cvj9Puj3u6E%2F1LE3aooHHI%2Fo8psXmAptz%2FFELfDLxWz7asksxIjeL5Jp2zTct3i5yJ%2BOI%2BK%2FBpwLSSwybnfBVgr%2BAAdTH7TXcgpZDtj2vu7heT8mOBWKzqdgEesLoxl7Es%2FE00QMZw8UQqWDENgmqxg81iMN8lQpJxFeIGxOvIV1hvl4WiRTQ2WyLSasSOUVJeKQcc2%2FYKpqGRK9NmaaoOUjCHkkykncKDeodRr7oc1ZkBwhkVWrwQyZD6ydARLLRSnGiG%2BsL4AoQln0eIf4w8c04rUW6LQB6B55DOjqTXFcGsyEA18khxoevQna2owYn0F0FUkySix6hVUtLrjWCyWiinZ8HQUJVohepBXkAesljYPxszvJZug8ZV%2F0odaWgCH%2FLeKwY3S3sc%2BZTXh7%2BfNpCzAfn8n06teNRdchPCVeYviXY6ISua18WyVt0ERimaWILi4hbujXkSRjZ25ZVuMTGGUlGOZ6L%2F8CwFRFPgjmEgFswPcOKTmKCwACYP70RKM8suxs3v5O7zeJrMXSoffkangmBLpLu1JGk1e1bHahcujykHcHTN05E17quGE%2FeIU52%2BO%2FrutlSpcih%2BGm2j4t5bw5Np%2FqBQXCWW7tnRgTbrfir0ilyxBUlKdKZ6Ho5AbJ%2FNdwj1ll1txcQs8TM2tevlm8iRb%2BRfBsTthwNpu%2B9kblc29vsTbMWXPnfaObap7wRrTcKKcOhC3r68dhOdmUnK6Vq6QtfbLdAfpXAjTNInFuJ8lxtDSrhn9274S%2BBMUf%2FoVt4BKWqrFX2HOIK%2BBMHygzIxo4JO0vNdt6RQqcmsyOtHPo%2F%2BL0RTHqvsHPYN%2Bs4QL3G06GQGgkaRsJenuDJA%2F3Ksg9f37d2VQtTENKSPt53p%2BUq%2FMCZFDUBNIrtfEA%2BOaC5ZS3mLs3CpgiEThtdRs5wz4MYHQLJ9PEEhc2M9xqu1r7TUCYGPc1mwyCTDzQjjmNy1PgsSoth6ZmsXnfwIbBK%2F6h5Fw6FXj4VG2i2aJsSksBvYphc6Q4bbTbR0Qpnc1qRrNbNf47KSSx2R7O6bkTYKv180czvBlq1tvYApe%2BeQckE%2BTfsBESmXzST8gLzEd4NLjUBfTqWT9t9h3FTm0aGAMzULM5ZwaFc3ouV1nsApm6qXkvYEHSMBSASaCO91edJ%2B0zfOgnoz0RHvkyfbYkvAWv%2BY%2FMSXz2cGyn375RX7RWzhdcQCXxscqZdKfm41a1TYYcTaSF3rRqYo7GSL%2BMQBrjqcPMzEVxTyR0FGOKP3t%2FYHQTxjsLCgELPSSxbEQEZ3qs6FhdU8W9jqPUb4WBizXXfcAqxlSDf9Jf7yte5SdwGAuNJNojIxm2a5ohqRMet5l3opcePUEpOILmeYa0%2FkGLuuoSm2D9BTlyr1%2BCcgU9rDX0vR5pNU0pIS7aD2rCZ2UQPRl0joUEnz4KueHnKy1wuXTX%2BlLp757qCQ0gWUU6Ak8Pf1mO3zyL30K3t3sJzsUDKwW3G76KO63AqThShaRxXwXZwWQVLc4T%2B8FeVk9xFbrq%2F4TRXFXe0Ug5yaO%2F65IbJ5bZa2zVnqsKAYPbQgKj3CbSZzYwMAwlX2%2B8RkwAjD9kbN2vTb97bXlB0b2Reibp68UELjIDCJNBr4kZQSkLHqAe3VKT%2BSUCQrCdi0CaySaa3qKp%2BQnkI9VFWP4NpmxLmhNxYTFRxfCpHRgjuG9F26f%2Bmt8kReYTY7gbGqgLsL%2FmBQnVKi%2BuRfdenYcTI9zX%2FAjhObfh1m5iWq6fUG%2BhVhMdf%2BBpel%2BKSSonhHZ9dpwwMS8gz1MbKaxF6XYhNHCLD7WupjmExD03E%2BL1HQA6uBfB4B2%2BWL%2FP4uZ8geQyz%2FeDVrfvD4hAzL4VGZCSgaUZhfaROik2Z9EEBotm2YtPt249yo3GEJbJk1bq6oLyVp2FU%2FNqDBy7oT2%2F3bAeBSJyznz6tFjCmjUUsQ1fycS8FqLCWbjDhftpLNhqu7Hi43bKfAjTBkbO5qHJ8QoB%2FhR4U5Enrj2m2Jp%2Bk1ZaWsKdRTLDeHAF913yiW5hJ%2BZwhRaeueo%2F2IzLihyURzz0DRRXE1xR%2BGvnk4K9HqHY5aAX2XSnz5YAoWWocd1g9QL2ZJ0mXz%2BgqqbiAQt5BcryrsLasmtxAypJeMOPTpiEfLRXo8Xt9e%2B%2B1qbTQxP0F9kXM82sIwLwCo4ot2OEhSTVXyZ8IyN1SLWEAIPiR0hpmrdbHSPid5yDJMJ7%2B9smJ7wW37y%2Bl%2BylucQ6vrQykkaqizVs9Bt6xrwgyNpma5cZQYdk7UximvO7THnXTBhRVk81mQZJHqbQ%2FM7gQ1ceiHLTtUgHXwoR7jhhkZRjUWKSY6mqX5cdClkjG%2BBUdH0II6fJTDKEiVEk7w6PUxfqo%2Bl0YZf82O1DLlHKvsd5SwYGQh%2B76jmEKf39jh1%2By1P0vGygs8NbiXDkGZ7mpCe5SYAqFgCb58ZNg7min5dKcWXQLYIBiOoWpQC%2Bg%2BdXS8WIg%2BC0%2FgGBRGpniwFLTMdUPZFClMuSrN1&cipher=aes-256-cbc&iv=pu2Cz62n95U6hn7OGblC6A%3D%3D
[2025-05-16T11:29:20.204Z] Form data keys: env_key, data, cipher, iv
[2025-05-16T11:29:20.206Z] Form field env_key: 7jio3WtQVYk49OYdSKhezHaEVbIvoRWfzEm3aCDw1d97m3w10fte7qnewiIHj+1KLpH8eg+mW1x1j9P3P61cXenTbJZrhiBrPifZybKh9/KLdp+XemUSGygswjCuklub0uIsVq5tFulZ83TLWsb+IczxPWLiBjEWkBFXtrToQn4=
[2025-05-16T11:29:20.207Z] Form field data: 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
[2025-05-16T11:29:20.210Z] Form field cipher: aes-256-cbc
[2025-05-16T11:29:20.211Z] Form field iv: pu2Cz62n95U6hn7OGblC6A==
[2025-05-16T11:29:20.212Z] Form data received:
[2025-05-16T11:29:20.213Z]   hasEnvKey: true
[2025-05-16T11:29:20.213Z]   hasData: true
[2025-05-16T11:29:20.213Z]   hasIv: true
[2025-05-16T11:29:20.214Z]   hasCipher: true
[2025-05-16T11:29:20.545Z] Decoded IPN response:
[2025-05-16T11:29:20.546Z] {
  "order": {
    "$": {
      "id": "SUB_1747394920185",
      "timestamp": "1747394920188",
      "type": "card"
    },
    "signature": "2WDB-4K4X-VHSY-QDT8-7GYE",
    "url": {
      "return": "https://544b-2a02-2f0d-260d-6c00-d13-5281-a6f7-9ce4.ngrok-free.app/api/mobilpay/return",
      "confirm": "https://544b-2a02-2f0d-260d-6c00-d13-5281-a6f7-9ce4.ngrok-free.app/api/mobilpay/ipn",
      "ipn": "https://544b-2a02-2f0d-260d-6c00-d13-5281-a6f7-9ce4.ngrok-free.app/api/mobilpay/ipn"
    },
    "invoice": {
      "$": {
        "currency": "RON",
        "amount": "20"
      },
      "details": "Subscription payment",
      "contact_info": {
        "billing": {
          "$": {
            "type": "person"
          },
          "first_name": "Platinum",
          "last_name": "Rizon",
          "address": "Strada Astrelor 57",
          "email": "platinum.socialev@gmail.com",
          "mobile_phone": "0722438098"
        },
        "shipping": {
          "$": {
            "type": "person"
          },
          "first_name": "Platinum",
          "last_name": "Rizon",
          "address": "Strada Astrelor 57",
          "email": "platinum.socialev@gmail.com",
          "mobile_phone": "0722438098"
        }
      }
    },
    "params": {
      "recurring": {
        "expiration_date": "2026-05-16",
        "frequency": {
          "days": "30"
        },
        "auto": "true"
      }
    },
    "ipn_cipher": "aes-256-cbc",
    "mobilpay": {
      "$": {
        "timestamp": "20250516142918",
        "crc": "82aa77dc9b4afc5e77dc32e5291a5106"
      },
      "action": "confirmed",
      "customer": {
        "$": {
          "type": "person"
        },
        "first_name": "Platinum",
        "last_name": "Rizon",
        "country": "642",
        "city": "Bucharest",
        "address": "Strada+Astrelor+57",
        "email": "platinum.socialev%40gmail.com",
        "mobile_phone": "40722438098"
      },
      "purchase": "2329316",
      "original_amount": "20.00",
      "processed_amount": "20.00",
      "current_payment_count": "1",
      "pan_masked": "990000****5098",
      "rrn": "NRD0TAT-j-Cm",
      "payment_instrument_id": "101609",
      "installments": "1",
      "error": {
        "_": "Tranzactie aprobata",
        "$": {
          "code": "0"
        }
      }
    }
  }
}
[2025-05-16T11:29:20.549Z] Transaction details:
[2025-05-16T11:29:20.550Z]   orderId: SUB_1747394920185
[2025-05-16T11:29:20.551Z]   status: confirmed
[2025-05-16T11:29:20.551Z]   timestamp: 1747394920188
[2025-05-16T11:29:20.552Z]   amount: 20.00
[2025-05-16T11:29:20.553Z]   maskedCard: 990000****5098
[2025-05-16T11:29:20.553Z]   paymentMethod: 101609
[2025-05-16T11:29:20.554Z]   isRecurring: true
[2025-05-16T11:29:20.556Z]   recurringDetails: {"expiration_date":"2026-05-16","frequency":{"days":"30"},"auto":"true"}
[2025-05-16T11:29:20.556Z]   error: {"_":"Tranzactie aprobata","$":{"code":"0"}}
[2025-05-16T11:29:20.957Z] Found order:
[2025-05-16T11:29:20.958Z] {"id":"682721684fa14de3d15f4b05","orderId":"SUB_1747394920185","userId":"682610c3bbc5ffbd72b05d00","planId":"681f2a3b17a7e84735b7892e","amount":20,"currency":"RON","status":"PENDING","subscriptionType":"Gold","createdAt":"2025-05-16T11:28:40.418Z","updatedAt":"2025-05-16T11:28:40.418Z","user":{"id":"682610c3bbc5ffbd72b05d00","clerkId":"user_2vB8PWy3gwSXrjXXTer6VVbdxDh","email":null,"firstName":"Feraru","lastName":"Andreusi","university":"uni_13","faculty":"fac_13_1","city":"Arad","year":"4","avatar":null,"isOnboarded":true,"isAdmin":false,"planType":"Premium","createdAt":"2025-05-15T16:05:23.557Z","updatedAt":"2025-05-16T10:54:39.717Z"},"plan":{"id":"681f2a3b17a7e84735b7892e","name":"Gold","price":28,"currency":"RON","features":["Unlimited projects","Priority support","Advanced features"],"createdAt":"2025-05-10T10:28:11.620Z","updatedAt":"2025-05-16T11:28:40.245Z"}}
[2025-05-16T11:29:20.959Z] Payment validation:
[2025-05-16T11:29:20.959Z]   status: confirmed
[2025-05-16T11:29:20.960Z]   errorCode: 0
[2025-05-16T11:29:20.960Z]   errorMessage: Tranzactie aprobata
[2025-05-16T11:29:20.961Z]   isErrorCode: false
[2025-05-16T11:29:20.961Z]   isSuccessStatus: true
[2025-05-16T11:29:20.962Z]   paymentStatus: COMPLETED
[2025-05-16T11:29:21.843Z] DB error updating order:
[2025-05-16T11:29:21.844Z] 
Invalid `prisma.subscription.create()` invocation:


Unique constraint failed on the constraint: `Subscription_userId_key`
[2025-05-18T09:38:11.971Z] [IPN_SETUP] SSL verification disabled for development environment
[2025-05-18T09:38:11.975Z] 
=== IPN REQUEST RECEIVED ===
[2025-05-18T09:38:11.977Z] Request URL: https://localhost:3000/api/mobilpay/ipn
[2025-05-18T09:38:11.977Z] Request method: POST
[2025-05-18T09:38:11.978Z] Request headers: {
  "accept-encoding": ", gzip",
  "content-length": "3475",
  "content-type": "application/x-www-form-urlencoded",
  "host": "febb-2a02-2f0d-260d-6c00-e1d2-ec69-3f0f-1614.ngrok-free.app",
  "user-agent": "Zend_Http_Client",
  "x-clerk-auth-message": "",
  "x-clerk-auth-reason": "dev-browser-missing",
  "x-clerk-auth-signature": "",
  "x-clerk-auth-status": "signed-out",
  "x-clerk-auth-token": "",
  "x-clerk-clerk-url": "https://febb-2a02-2f0d-260d-6c00-e1d2-ec69-3f0f-1614.ngrok-free.app/api/mobilpay/ipn",
  "x-forwarded-for": "217.156.103.69",
  "x-forwarded-host": "febb-2a02-2f0d-260d-6c00-e1d2-ec69-3f0f-1614.ngrok-free.app",
  "x-forwarded-port": "3000",
  "x-forwarded-proto": "https"
}
[2025-05-18T09:38:11.983Z] Raw request body: env_key=dfN3GxIRhbXW47fU8MV0U3mXZC2Bm7NjmRpb0Mxi5FYTLY%2FuluVFHXgIzs%2F%2FU005ALws96L6Salc%2FtsDP0Zenhe%2F%2BWWwMLr%2B6eroEa%2BSCYk5FajKahXWyrBQymYyo0bf%2FzB%2FKB1rnLgLzyw5Xfw9%2B7beNVQLBcpw16sopxLFgz0%3D&data=Kvi7hfVsd7W38qL4%2BImzGOt3jBispMnJHMf6MtBVs2y14Wpm9PM4rdLcKZrcI1LF%2FUuUFWmASBilIajU4fFeAAwgI1LRiuqoVDJt4arvWSdVwdNN57mspYR1%2By4m1g1fu3Kao6gxVUr0Av0V83kP%2BPQypQXDG8WX5yvEOdjEf%2FBytV8Pw5auMIKndsoUxFEocDW0tuEIlnQIBkLMSBLj%2FbWe%2FJ%2Fr49hmO8dS3Av8oUTmFIBHzlnoLQWeTCNX%2BXY398LNAevuZgm69zNDLPPnz6RckPpDoudUR1cVzbTVEa496zNCQNvGpNIlEYA3gm%2FeqlbZGmp0UFsXNuTdVAFQqqWrucza%2FqVREpLGzytiJo42wmW%2B3a4qfgtQKsy%2BiWJ%2FUHcTjwgrjRNg1whmzHMUwZWNtVwyM3f1QGBEr9IIPAHj5RbB4%2BZGFMBd3XPBVbZBvLTikUUz%2FQe62sWHna7H4I46qDEeyq%2BS50rp3Y3Ul1u1V7OGBqWjRA5vG1BVuQRzMgYBss4x8Wji9I7N9ciZBwp5hCNYvwnL6KKU%2F5oKbm6uVFtUtS16Oi95qiA%2FQ7%2F2LXZfF7lgfe89HPDWK3wZ8XUb4Ouq6IwjBt0IGDjOJiUaLG1IDwpGbyxt3UZosHmSE%2FxXGzHOfufPElliLwgUPnMJ51Ij7j3KJqJeH7uniFOgEjD11ywBSPRBIgrsJigmb5FYIqbwoYq5MpSOfGxsx1DTkt9xhbWuftu4fheNlbOoNqU0uaj2q6pfGjYox9XPQCYoUyzeCywHgwvhEaSr1pmB3UOtuvwllaeNLkpPnfXlMpnJydbj%2B0sZxNXzakQ0kKpTab3ijhQpCubc9YXKeWqZEpK6%2FSZT0Ib%2FUReJQHkSgYaRnBUhVSOY9AN0b1th2vcEs2w3446HQMJUdpKETvOAtSP7CthUIO8oEu8rcdmmj%2FfCkDwWJImVhVnbJRUJAemYuz0Rd1m7WwCZ8iBYzHTIw8MGZisunKUWMyDsUXYlgQmqIj8w82IKragfiprKHq18D6R0hWZpZ9PRd2njon5arTT5%2BmdqMsqkjNrT6tSpQDdVuY0rWsuEU2Rx%2F%2FklXJc4Ko6wjHUylRUPbeWXG%2FHX2yhL%2FUWQaRs5JtqJpzh2FeOz5wqcmUPaHKkvZH5QEuvnqVrozpAFTrYFZ9uAfMTo9Zl4Y1Xgm3SXODZyandoOBk49FilPi%2BeMqQoz1qMC0jh1daEkPLoR5HSfMmLboRp6Mno%2FXEUoevCJL3AdFws9eC8%2F9SSXcm1oDOCO9q4CpR8y0ciD57GiUCjJ1DJNhLiHalS0UJU6tUaiq9wSz1jcJ1TkPsM6pvyO9fJmQGAxTVNkxM5bBISI6nq%2FhlbMbArkLPJhfWQSmuKH9LdsArp5RM1JYwiRezwWtQ7cMUMAZdi8VY1zborGOIetUCgRed3iU4E5PuKnocE4I1yJ%2BnuNOYi4qzDxwd37JFtYCjvK2fFuRPY6aPthA2Jjy20stqrUDw1e6k0B%2F6xYU8l3YwY4Vlm%2BHOmJPui2fZE8VrSGNYOekQxLwvS9XPNYiiH9vtnzM7JpcunQIO3chTLHHjy%2BFvyiqTZIgQh%2F158KAZhZWxTky89Lr4TrSx7FjZcKeIw9bBUKhCeTZHJ%2FVU%2BzBYfoTRjeLCqzRpg2%2FvW7ccHqcWoKDcF2WuTv9u5NsiBvdJm12rZUqpYqefhLcYdPxUHUWWZVHQOyrYU5IjGJNKTiD1Hirg8lD3VeGl5sTdkUhC%2FK4YgFzdU%2FwP50QO6eNhQAORkOgcmdy5oKcPjiumdSDqytjC8LH9rybqYV%2BqizRE7Q2s5YEz%2Fbuu4Kh8KmvUGFwJ9HnEOGUoyUBg6bPNzdwXur64ocRui02pG7Bo4P0zEAmvLJiYfTNMG%2BK4RBRfX6aJYEesX2RsBxDGdSRUwkOq%2Fr4czGZZ6o3pkdkaSjHP1s6gk2DwMRR9T5cfbVIqk2gb%2BE7mBOf5dA1AT16ERmOeyM3a%2BTierYcVqbqnTht4AXefl9I%2BC4LIrc%2FvS3jbcJZeXTwv9sfPpl4Lv8cIuLZvL1CMEZejQ%2F1cMfWSTbRuuiftKxIfHqD5884cN3XWBZxeFVE0ku21GJXdZYdhI0k1FxfmMv5WDZm7ne0jfcKvq5mDLaroTYpKJYe8pnXrisoZmLyqfoiUPiFnzneYAAE2%2FJVMOLToJzYE6rNWObNELlfE6n8sxh%2F749AtU7xsdiARxGFR53Lljo5J4%2BEcB6oQJQJVjJN2q1U2S2nF33mS3Z%2F9SQRLOgTypiqsNWYGSSkdahUAViFWYiQNbqd4nRrWvtHpbe9O6gasQsxzZSmwdi44nIWTZZNVrHGHkLxb8Bo6GqGgocRp8BWMxHg1TzFfhkV0qOSqygqfJTOCZKiSXrzqHJba9CXOM6afPntkZlsUtKLMGDvP79tCc%2FukZCUlTAiru5cj4meETe9td%2BccCvO6Fv5f7C5dNjhjrcYlSv2KhbC2ItegJy%2FhSP8bspsvfLJfOXX6caPhUtVVenqy5wiK5MSlURf1AJ7C8SJv5jRDGnCwvRmsRS3vWubBCBbj7pLcKK9rqjMKsAqgbn05vPmt6mmSEP0kphR2i0N1GskTiONAFYXhLKgK%2FQLzn6bV1bBggaOs1PKRbg3Q1oL5MbCC4EgKwJHsdqfPAnITruRAowmeGqdH2SqMSjU1VRaJ63TfNnjDqYHaEchWj2I6ERnQp%2FQNm5jtUkk2XJHrTMvJhbVcJu3Ah0RHfiTtSJ3001HFc%2F%2FI2euUbxQS7XI%2FdG7hEGjEjmWGE%2FMPau23y4NDkhvhtcfEyCDL8fqMEPHHCB3%2BeUwCRic4sQmCJ8s6cE2F5dYbT%2FgXloqY9D20mUOwi8s%2BzwCyazRFSrT4ZSCpIy%2Bc%2F7T1NtdEDIum5%2FX2Y4e02G1IkEbTpTX6YUOLX%2Fma98BxDCfjbMKXI7RUpqmkHyxYmw1uczcU4XbAxH4ynP9b%2Fm0tipQ%2FvXUUyez3O4RvkepGBFKQSX%2Be9CVRlJyZ%2Bk7WCfpEColfhae1bKtKajaVW5kH3KXgjO3XXcBk%3D&cipher=aes-256-cbc&iv=fyx2HIb%2B%2FgATTv4j2YQ%2F2g%3D%3D
[2025-05-18T09:38:11.989Z] Form data keys: env_key, data, cipher, iv
[2025-05-18T09:38:11.990Z] Form field env_key: dfN3GxIRhbXW47fU8MV0U3mXZC2Bm7NjmRpb0Mxi5FYTLY/uluVFHXgIzs//U005ALws96L6Salc/tsDP0Zenhe/+WWwMLr+6eroEa+SCYk5FajKahXWyrBQymYyo0bf/zB/KB1rnLgLzyw5Xfw9+7beNVQLBcpw16sopxLFgz0=
[2025-05-18T09:38:11.992Z] Form field data: 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
[2025-05-18T09:38:11.993Z] Form field cipher: aes-256-cbc
[2025-05-18T09:38:11.994Z] Form field iv: fyx2HIb+/gATTv4j2YQ/2g==
[2025-05-18T09:38:11.996Z] Form data received:
[2025-05-18T09:38:11.997Z]   hasEnvKey: true
[2025-05-18T09:38:11.998Z]   hasData: true
[2025-05-18T09:38:11.999Z]   hasIv: true
[2025-05-18T09:38:11.999Z]   hasCipher: true
[2025-05-18T09:38:12.245Z] Decoded IPN response:
[2025-05-18T09:38:12.246Z] {
  "order": {
    "$": {
      "id": "SUB_1747561055547",
      "timestamp": "1747561055549",
      "type": "card"
    },
    "signature": "2WDB-4K4X-VHSY-QDT8-7GYE",
    "url": {
      "return": "https://febb-2a02-2f0d-260d-6c00-e1d2-ec69-3f0f-1614.ngrok-free.app/api/mobilpay/return",
      "confirm": "https://febb-2a02-2f0d-260d-6c00-e1d2-ec69-3f0f-1614.ngrok-free.app/api/mobilpay/ipn",
      "ipn": "https://febb-2a02-2f0d-260d-6c00-e1d2-ec69-3f0f-1614.ngrok-free.app/api/mobilpay/ipn"
    },
    "invoice": {
      "$": {
        "currency": "RON",
        "amount": "8"
      },
      "details": "Subscription payment",
      "contact_info": {
        "billing": {
          "$": {
            "type": "person"
          },
          "first_name": "GrizzlyMedia",
          "last_name": "Rizon",
          "address": "Strada Postalionului 69-71",
          "email": "grizzlymediapro@gmail.com",
          "mobile_phone": "0722438098"
        },
        "shipping": {
          "$": {
            "type": "person"
          },
          "first_name": "GrizzlyMedia",
          "last_name": "Rizon",
          "address": "Strada Postalionului 69-71",
          "email": "grizzlymediapro@gmail.com",
          "mobile_phone": "0722438098"
        }
      }
    },
    "params": {
      "recurring": {
        "expiration_date": "2026-05-18",
        "frequency": {
          "days": "30"
        },
        "auto": "true"
      }
    },
    "ipn_cipher": "aes-256-cbc",
    "mobilpay": {
      "$": {
        "timestamp": "20250518123809",
        "crc": "9c651ed5bb8d132fa4f408e082c2265a"
      },
      "action": "confirmed",
      "customer": {
        "$": {
          "type": "person"
        },
        "first_name": "GrizzlyMedia",
        "last_name": "Rizon",
        "country": "642",
        "city": "Bucharest",
        "address": "Strada+Postalionului+69-71",
        "email": "grizzlymediapro%40gmail.com",
        "mobile_phone": "40722438098"
      },
      "purchase": "2331085",
      "original_amount": "8.00",
      "processed_amount": "8.00",
      "current_payment_count": "1",
      "pan_masked": "990000****5098",
      "rrn": "zsSTguwe6BBf",
      "payment_instrument_id": "101609",
      "installments": "1",
      "error": {
        "_": "Tranzactie aprobata",
        "$": {
          "code": "0"
        }
      }
    }
  }
}
[2025-05-18T09:38:12.248Z] Transaction details:
[2025-05-18T09:38:12.249Z]   orderId: SUB_1747561055547
[2025-05-18T09:38:12.258Z]   status: confirmed
[2025-05-18T09:38:12.259Z]   timestamp: 1747561055549
[2025-05-18T09:38:12.260Z]   amount: 8.00
[2025-05-18T09:38:12.261Z]   maskedCard: 990000****5098
[2025-05-18T09:38:12.262Z]   paymentMethod: 101609
[2025-05-18T09:38:12.262Z]   isRecurring: true
[2025-05-18T09:38:12.264Z]   recurringDetails: {"expiration_date":"2026-05-18","frequency":{"days":"30"},"auto":"true"}
[2025-05-18T09:38:12.265Z]   error: {"_":"Tranzactie aprobata","$":{"code":"0"}}
[2025-05-18T09:38:12.569Z] Found order:
[2025-05-18T09:38:12.570Z] {"id":"6829aa5f7b58a30e584ad40c","orderId":"SUB_1747561055547","userId":"6829aa407b58a30e584ad40b","planId":"681f2e8717a7e84735b78931","amount":8,"currency":"RON","status":"PENDING","subscriptionType":"Premium","createdAt":"2025-05-18T09:37:35.796Z","updatedAt":"2025-05-18T09:37:35.796Z","user":{"id":"6829aa407b58a30e584ad40b","clerkId":"user_2xGOaQLFAUh0YAdBmygQvtnVWL3","email":null,"firstName":"Teodor-Alexandru","lastName":"Rizon","university":"Universitatea Națională de Educație Fizică și Sport din București","faculty":"Facultatea de Kinetoterapie","city":"București","year":"4","avatar":null,"isOnboarded":true,"isAdmin":false,"planType":"Basic","createdAt":"2025-05-18T09:37:04.166Z","updatedAt":"2025-05-18T09:37:04.166Z"},"plan":{"id":"681f2e8717a7e84735b78931","name":"Premium","price":8,"currency":"RON","features":["Unlimited projects","Priority support"],"createdAt":"2025-05-10T10:46:31.408Z","updatedAt":"2025-05-18T09:37:35.642Z"}}
[2025-05-18T09:38:12.570Z] Payment validation:
[2025-05-18T09:38:12.571Z]   status: confirmed
[2025-05-18T09:38:12.571Z]   errorCode: 0
[2025-05-18T09:38:12.572Z]   errorMessage: Tranzactie aprobata
[2025-05-18T09:38:12.572Z]   isErrorCode: false
[2025-05-18T09:38:12.572Z]   isSuccessStatus: true
[2025-05-18T09:38:12.573Z]   paymentStatus: COMPLETED
[2025-05-18T09:38:13.233Z] --- IPN DEBUG END ---
